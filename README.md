# CV-13 Level 2 Object Detection í”„ë¡œì íŠ¸

> ## ëŒ€íšŒ ê°œìš”: ì§€êµ¬ í™˜ê²½ ë³´í˜¸ë¥¼ ìœ„í•œ ì“°ë ˆê¸° ê°ì§€ ëª¨ë¸ ê°œë°œ ëŒ€íšŒ 

### ë°°ê²½
í˜„ëŒ€ ì‚¬íšŒëŠ” ëŒ€ëŸ‰ ìƒì‚°ê³¼ ëŒ€ëŸ‰ ì†Œë¹„ì˜ ì‹œëŒ€ë¡œ, ì´ëŠ” 'ì“°ë ˆê¸° ëŒ€ë€' ë° 'ë§¤ë¦½ì§€ ë¶€ì¡±'ê³¼ ê°™ì€ ë‹¤ì–‘í•œ í™˜ê²½ ë¬¸ì œë¥¼ ì´ˆë˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œì— ëŒ€ì‘í•˜ê¸° ìœ„í•´, ë¶„ë¦¬ìˆ˜ê±°ëŠ” í•„ìˆ˜ì ì¸ í™œë™ìœ¼ë¡œ ìë¦¬ ì¡ì•˜ìŠµë‹ˆë‹¤. ì •í™•í•˜ê²Œ ë¶„ë¥˜ëœ ì“°ë ˆê¸°ëŠ” ìì›ìœ¼ë¡œ ì¬í™œìš©ë  ìˆ˜ ìˆëŠ” ê°€ì¹˜ë¥¼ ì§€ë‹ˆì§€ë§Œ, ì˜ëª» ë¶„ë¥˜ë˜ë©´ ë§¤ë¦½ì§€ë‚˜ ì†Œê°ì¥ìœ¼ë¡œ í–¥í•˜ê²Œ ë©ë‹ˆë‹¤. 

### ëª©ì 
ì´ ëŒ€íšŒëŠ” ì‚¬ì§„ ì† ì“°ë ˆê¸°ë¥¼ ì •í™•í•˜ê²Œ ê°ì§€í•˜ê³  ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ëª¨ë¸ì„ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ì°¸ê°€ìë“¤ì—ê²Œ ì œê³µë˜ëŠ” ë°ì´í„°ì…‹ì€ ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ì“°ë ˆê¸°(ì¼ë°˜ ì“°ë ˆê¸°, í”Œë¼ìŠ¤í‹±, ì¢…ì´, ìœ ë¦¬ ë“± 10ì¢…)ê°€ ë‹´ê¸´ ì‚¬ì§„ë“¤ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ì´ë¥¼ í™œìš©í•˜ì—¬ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

### ì‘ìš© ê°€ëŠ¥ì„±
ì„±ê³µì ìœ¼ë¡œ ê°œë°œëœ ëª¨ë¸ì€ ì“°ë ˆê¸°ì¥ì— ì„¤ì¹˜ë˜ì–´ ì •í™•í•œ ë¶„ë¦¬ìˆ˜ê±°ë¥¼ ë•ê±°ë‚˜, ì–´ë¦°ì´ë“¤ì˜ ë¶„ë¦¬ìˆ˜ê±° êµìœ¡ì— í™œìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì§€êµ¬ í™˜ê²½ ë³´í˜¸ì— ê¸°ì—¬í•˜ê³ , ì•¼ìƒë™ë¬¼ì˜ ìƒê³„ ìœ„í˜‘ê³¼ ê°™ì€ ë¬¸ì œë¥¼ ì™„í™”í•˜ëŠ” ë° ë„ì›€ì„ ì¤„ ê²ƒì…ë‹ˆë‹¤. ë˜í•œ, ì´ ê¸°ìˆ ì€ ì“°ë ˆê¸°ë¥¼ ì¤ëŠ” ë“œë¡ , ì“°ë ˆê¸° ë°°ì¶œ ë°©ì§€ ë¹„ë””ì˜¤ ê°ì‹œ, ì¸ê°„ì˜ ì“°ë ˆê¸° ë¶„ë¥˜ë¥¼ ë•ëŠ” AR ê¸°ìˆ  ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì— ì‘ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

### ë°ì´í„°ì…‹ê³¼ í‰ê°€ ë°©ë²•
- **Input**: ì“°ë ˆê¸° ê°ì²´ê°€ ë‹´ê¸´ ì´ë¯¸ì§€ 
- **Annotations**: bbox ì •ë³´ (ì¢Œí‘œ, ì¹´í…Œê³ ë¦¬), COCO formatìœ¼ë¡œ ì œê³µ 
- **Output**: ëª¨ë¸ì€ bbox ì¢Œí‘œ, ì¹´í…Œê³ ë¦¬, score ê°’ì„ ë¦¬í„´í•´ì•¼ í•˜ë©°, ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ submission ì–‘ì‹ì— ë§ëŠ” csv íŒŒì¼ì„ ìƒì„±í•˜ì—¬ ì œì¶œ 

### ìš”ì•½
ì´ ëŒ€íšŒëŠ” ì§€êµ¬ í™˜ê²½ ë³´í˜¸ì— ê¸°ì—¬í•  ìˆ˜ ìˆëŠ” ì“°ë ˆê¸° ê°ì§€ ë° ë¶„ë¥˜ ëª¨ë¸ì„ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ì œê³µë˜ëŠ” ë°ì´í„°ì…‹ì„ í™œìš©í•´ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê³ , ì´ë¥¼ í†µí•´ ë¶„ë¦¬ìˆ˜ê±°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ íƒìƒ‰í•©ë‹ˆë‹¤. ì´ ê¸°ìˆ ì€ ì“°ë ˆê¸° ì²˜ë¦¬ ì‹œì„¤ì˜ íš¨ìœ¨ì„±ì„ ë†’ì´ê³ , í™˜ê²½ êµìœ¡ì—ë„ ì‘ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì°¸ê°€ìë“¤ì€ ì§€êµ¬ í™˜ê²½ ë³´í˜¸ë¥¼ ìœ„í•œ ì¤‘ìš”í•œ ì¼ì— ê¸°ì—¬í•˜ëŠ” ë™ì‹œì—, ì¸ê³µì§€ëŠ¥ê³¼ ê¸°ê³„ í•™ìŠµ ë¶„ì•¼ì—ì„œ ì‹¤ì§ˆì ì¸ ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ì„ í‚¤ìš¸ ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. 

> ## Project Structure

```
ğŸ“¦level2-objectdetection-cv-13
â”£ ğŸ“‚ eda
â”ƒ â”£ ğŸ“œ eda.ipynb
â”ƒ â”£ ğŸ“œ labelme_to_coco.py
â”ƒ â”£ ğŸ“œ object_add_algorithm.ipynb
â”ƒ â”£ ğŸ“œ show_image.ipynb
â”ƒ â”£ ğŸ“œ show_test_image.ipynb
â”£ ğŸ“‚ pytorch
â”£ ğŸ“‚ detectron2
â”£ ğŸ“‚ deta
â”£ ğŸ“‚ efficientdet
â”£ ğŸ“‚ yolov8
â”£ ğŸ“‚ mmdetection
â”ƒ â”£ ğŸ“‚configs
â”ƒ â”ƒ â”£ ğŸ“‚_base_
â”ƒ â”ƒ â”£ ğŸ“‚_teamconfig_
â”ƒ â”£ ğŸ“‚mmdet
â”ƒ â”— ğŸ“œtrain.py
â”ƒ â”— ğŸ“œtest.py
â”£ ğŸ“œ small_box.ipynb
â”£ ğŸ“œ upsampling.ipynb
â”£ ğŸ“œ wbf_ensemble.ipynb
â”£ ğŸ“œ Train-valid_Split.ipynb
â”— ğŸ“œ README.md
```

> ## DINO ì‹¤í–‰ ë°©ë²• ë° ì½”ë“œ

### 1. `dino_requirements.txt` ì„¤ì¹˜

```
pip install -r dino_requirements.txt
```

### 2. `Train.py` ì‹¤í–‰

```
python mmdetectionv3/train.py {config í´ë” ê²½ë¡œ} --work-dir {ëª¨ë¸ì´ ì €ì¥ë  ê²½ë¡œ}

# DINO Train:

python mmdetectionv3/train.py mmdetectionv3/configs/_teamconfig_/dinonoval/config.py --work-dir results/dino
```

### 3. `Test.py` ì‹¤í–‰

```
python mmdetectionv3/test.py {config í´ë” ê²½ë¡œ} {ëª¨ë¸ ì²´í¬í¬ì¸íŠ¸ ê²½ë¡œ} --work-dir {ê²°ê³¼ê°€ ì €ì¥ë  ê²½ë¡œ}

# DINO Test:

python mmdetectionv3/test.py mmdetectionv3/configs/_teamconfig_/dinonoval/config.py results/dino/best.pth --work-dir out/dino
```


> ## Cascade R-CNN ì‹¤í–‰ ë°©ë²• ë° ì½”ë“œ

### 1. `cascade_requirements.txt` ì„¤ì¹˜

```
pip install -r cascade_requirements.txt
```

### 2. `Train.py` ì‹¤í–‰

```
python mmdetection/train.py --config {_teamconfig_ì•ˆì— ìˆëŠ” í´ë”ëª…}/{configíŒŒì¼ëª…} --exp-name {ì‹¤í—˜ëª…} --work-dir {ëª¨ë¸ì„ ì €ì¥í•  ê²½ë¡œ} --epochs {epoch ê°¯ìˆ˜}

# Cascade Train:

python mmdetection/train.py --config cascade_rcnn/cascade_rcnn_config.py --exp-name cascade --work-dir results/cascade --epochs 15
```

### 3. `Test.py` ì‹¤í–‰

```
python mmdetection/test.py --config {_teamconfig_ì•ˆì— ìˆëŠ” í´ë”ëª…}/{configíŒŒì¼ëª…} --checkpoint {ëª¨ë¸ì´ ì €ì¥ëœ ê²½ë¡œ}

# Cascade Test:

python mmdetection/test.py --config cascade_rcnn/cascade_rcnn_config.py --checkpoint results/cascade/best.pth
```


> ## Ensemble ë°©ë²•

- wbf_ensemble.ipynb íŒŒì¼ì—ì„œ csvíŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •í•œ í›„ ì•™ìƒë¸”í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

> ## ìµœì¢… ëª¨ë¸
<p align = "center">
<img height="400px" width="800px" src="https://github.com/boostcampaitech6/level2-objectdetection-cv-13/assets/78347296/9ed84f59-178b-4fad-844a-684a7b47557c">
<p/>

### K-fold Ensemble of Cascade R-CNN with Swin-Large Backbone + DINO with Swin-Large Backbone

- Swin-Largeë¥¼ Backboneìœ¼ë¡œ ì‚¬ìš©í•œ Cascade R-CNNì€ 5ê°œì˜ í´ë“œë¡œ ë‚˜ëˆ„ì–´ WBF Ensembleì„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

- Swin-Largeë¥¼ Backboneìœ¼ë¡œ ì‚¬ìš©í•œ DINOëŠ” Train set ì „ì²´ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

- ìµœì¢…ì ìœ¼ë¡œ ìœ„ ë‘ ëª¨ë¸ì„ NMS Ensembleí•˜ì˜€ê³ , ê·¸ ê²°ê³¼ ë¦¬ë”ë³´ë“œ Public mAP_50 0.7013, Private mAP_50 0.6850ì„ ê¸°ë¡í•˜ì˜€ìŠµë‹ˆë‹¤.
